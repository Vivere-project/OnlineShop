{"ast":null,"code":"import _asyncToGenerator from \"/Users/valeriuseremet/Projects/OnlineShop/OnlineShop.Web/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { ItemCount } from \"../models/cart\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./local-storage.service\";\nexport class CartService {\n  constructor(localStorageService) {\n    this.localStorageService = localStorageService;\n  }\n\n  addItem(item) {\n    let cart = [];\n    this.localStorageService.subscribe(data => cart = data.cart);\n\n    if (cart[item.id]) {\n      cart[item.id].count += 1;\n      this.localStorageService.addToStorage(\"cart\", JSON.stringify(cart));\n    } else {\n      this.localStorageService.subscribe(data => {\n        data.itemsCache.forEach(item_ => {\n          cart[item_.id] = new ItemCount(item_, item_.id == item.id ? 1 : 0);\n        });\n      });\n      this.localStorageService.addToStorage(\"cart\", JSON.stringify([item]));\n    }\n  }\n\n  addItems(item, count) {\n    let cart = {};\n    this.localStorageService.subscribe(data => cart = data.cart);\n\n    if (cart[item.id] != null) {\n      cart[item.id].count += count;\n      this.localStorageService.addToStorage(\"cart\", JSON.stringify(cart));\n    } else {\n      cart = {};\n      this.localStorageService.subscribe(data => {\n        data.itemsCache.forEach(item_ => {\n          cart[item_.id] = new ItemCount(item_, item_.id == item.id ? count : 0);\n        });\n      });\n      this.localStorageService.addToStorage(\"cart\", JSON.stringify(cart));\n    }\n  }\n\n  getItems() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      let cart = {};\n\n      _this.localStorageService.subscribe(data => cart = data.cart); // let a = await this.localStorageService.\n\n\n      return cart;\n    })();\n  }\n\n  removeItems() {\n    this.localStorageService.removeFromStorage('cart'); // localStorage.setItem('cart', \"\");\n  }\n\n}\n\nCartService.ɵfac = function CartService_Factory(t) {\n  return new (t || CartService)(i0.ɵɵinject(i1.LocalStorageService));\n};\n\nCartService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CartService,\n  factory: CartService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/Users/valeriuseremet/Projects/OnlineShop/OnlineShop.Web/src/app/services/cart.service.ts"],"names":["ItemCount","i0","i1","CartService","constructor","localStorageService","addItem","item","cart","subscribe","data","id","count","addToStorage","JSON","stringify","itemsCache","forEach","item_","addItems","getItems","removeItems","removeFromStorage","ɵfac","CartService_Factory","t","ɵɵinject","LocalStorageService","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import { ItemCount } from \"../models/cart\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./local-storage.service\";\nexport class CartService {\n    constructor(localStorageService) {\n        this.localStorageService = localStorageService;\n    }\n    addItem(item) {\n        let cart = [];\n        this.localStorageService.subscribe(data => cart = data.cart);\n        if (cart[item.id]) {\n            cart[item.id].count += 1;\n            this.localStorageService.addToStorage(\"cart\", JSON.stringify(cart));\n        }\n        else {\n            this.localStorageService.subscribe(data => {\n                data.itemsCache.forEach(item_ => {\n                    cart[item_.id] = new ItemCount(item_, item_.id == item.id ? 1 : 0);\n                });\n            });\n            this.localStorageService.addToStorage(\"cart\", JSON.stringify([item]));\n        }\n    }\n    addItems(item, count) {\n        let cart = {};\n        this.localStorageService.subscribe(data => cart = data.cart);\n        if (cart[item.id] != null) {\n            cart[item.id].count += count;\n            this.localStorageService.addToStorage(\"cart\", JSON.stringify(cart));\n        }\n        else {\n            cart = {};\n            this.localStorageService.subscribe(data => {\n                data.itemsCache.forEach(item_ => {\n                    cart[item_.id] = new ItemCount(item_, item_.id == item.id ? count : 0);\n                });\n            });\n            this.localStorageService.addToStorage(\"cart\", JSON.stringify(cart));\n        }\n    }\n    async getItems() {\n        let cart = {};\n        this.localStorageService.subscribe(data => cart = data.cart);\n        // let a = await this.localStorageService.\n        return cart;\n    }\n    removeItems() {\n        this.localStorageService.removeFromStorage('cart');\n        // localStorage.setItem('cart', \"\");\n    }\n}\nCartService.ɵfac = function CartService_Factory(t) { return new (t || CartService)(i0.ɵɵinject(i1.LocalStorageService)); };\nCartService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: CartService, factory: CartService.ɵfac, providedIn: 'root' });\n"]},"metadata":{},"sourceType":"module"}